
## 📈  **'모멘텀 기반의 시가총액 가중 재배정(Rebalancing)'**  전략 검증을 위한 시스템 프롬프트

> **[주제: 시가총액 상위 10개 종목 동일비중 리밸런싱 전략 백테스팅]**
> **1. 분석 목적:**
> 특정 시장(예: KOSPI)에서 시가총액 상위 1등~10등 종목을 동일 비중(10%씩)으로 매수하고, 1년 주기로 리밸런싱했을 때의 수익률을 시장 지수(Benchmark)와 비교 검증하고자 함.
> **2. 상세 조건:**
> * **대상 시장:** 한국 KOSPI 시장
> * **투자 기간:** 최근 10년 (데이터 가용 범위 내 최대)
> * **포트폴리오 구성:** 매년 초 시가총액 기준 상위 10개 종목 선정
> * **비중:** 각 종목당 1/N (10%씩 동일 비중)
> * **리밸런싱 주기:** 12개월 (매년 1회)
> * **매매 규칙:** 10위권 밖으로 밀려난 종목은 전량 매도, 새로 진입한 종목은 신규 매수하여 다시 10% 비중 정렬.
> * **비교 대상(Benchmark):** KOSPI 지수 수익률
> 
> 
> **3. 출력 요구사항:**
> * `yfinance` 또는 `Pandas_datareader` 라이브러리를 사용하여 실제 데이터를 불러오는 파이썬 코드를 작성해줘.
> * **결과 지표:** 누적 수익률(Cumulative Return), 연평균 성장률(CAGR), 최대 낙폭(MDD), 샤프 지수(Sharpe Ratio)를 계산해줘.
> * **시각화:** 전략 수익률과 벤치마크 지수 수익률을 비교하는 그래프를 그려줘.
> 
> 
> **4. 예외 처리:**
> * 상장 폐지나 데이터 누락 종목은 제외하고 계산할 것.
> * 거래 수수료(약 0.2%)와 세금을 고려한 수익률 산출 로직을 포함해줘.
> 
> 

---

## 💡 이 전략을 검증할 때 주의할 점 (Insight)

프로그램을 돌려보기 전에, 전략의 핵심 포인트 3가지를 기억하세요.

1. **생존 편향 (Survival Bias):** 과거 데이터를 볼 때 '지금 잘나가는 기업'만 놓고 계산하면 안 됩니다. 10년 전에는 1위였으나 지금은 사라진 기업까지 포함된 데이터를 써야 정확한 검증이 됩니다.
2. **리밸런싱 비용:** 1년마다 갈아치울 때 발생하는 세금과 수수료가 수익률을 깎아먹을 수 있습니다. 코드 결과에서 이 부분을 꼭 확인해야 합니다.
3. **동일 비중 vs 시가총액 비중:** 10만 원씩 똑같이 사는 **'동일 비중(Equal Weight)'**을 말씀하셨습니다. 이는 1등주보다 10등주의 등락에 더 민감하게 반응하게 되는데, 종종 이 방식이 지수(시가총액 가중 방식)보다 높은 수익률을 내는 원천이 되기도 합니다.
